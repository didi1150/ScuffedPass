import{a as fe,g as ge,s as ye}from"../chunks/axios.B3ERvgox.js";import{s as J,e as g,b as A,d as y,f as R,p as U,j as D,i as O,q as v,k as P,l as _,x as N,r as L,z as ce,n as z,y as de,A as ne,S as Oe,v as pe,c as Ce,u as Te,g as Ee,a as ke,t as H,h as F,m as he,T as Ae,D as j,U as K,V as me,o as De}from"../chunks/scheduler.B1oJxWRp.js";import{S as Q,i as X,t as q,g as Pe,a as I,c as Be,f as V,b as W,d as G,m as $,e as Y}from"../chunks/index.DtR5D7br.js";import{p as Se}from"../chunks/stores.CCV25G2G.js";import{c as Ue}from"../chunks/authenticationCheck.D5ITmbYD.js";function Z(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}const Le=async()=>{const t=await fe.get("/vault");try{if(t.data&&Array.isArray(t.data))return{passwords:t.data.map(n=>({website:n.websiteURL,email:n.email,password:n.password,iv:n.iv}))}}catch(e){return console.error("Failed to fetch passwords:",e),{responseArray:[]}}},at=Object.freeze(Object.defineProperty({__proto__:null,load:Le},Symbol.toStringTag,{value:"Module"})),Re=typeof window<"u"&&typeof window.localStorage<"u",_e=async(t,e)=>{if(Re){const n=new TextEncoder,s=await crypto.subtle.importKey("raw",n.encode(t),"PBKDF2",!1,["deriveBits","deriveKey"]),a={name:"PBKDF2",salt:be(e),iterations:1e5,hash:"SHA-256"};return await crypto.subtle.deriveKey(a,s,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}},Ne=async(t,e,n)=>{const s=await _e(t,e);if(!s)return"ERROR";const a=crypto.getRandomValues(new Uint8Array(12)),r=Me(await crypto.subtle.encrypt({name:"AES-GCM",iv:a},s,new TextEncoder().encode(n)));return{iv:ve(a),encryptedData:r}},qe=async(t,e,n,s)=>{const a=se(s);ve(a);const r=await _e(t,e);if(!r)return"ERROR";const i=be(n),c=se(s);try{const p=await crypto.subtle.decrypt({name:"AES-GCM",iv:c},r,i);return new TextDecoder().decode(p)}catch(p){console.error(p)}},Me=t=>{let e="";const n=new Uint8Array(t),s=n.byteLength;for(let a=0;a<s;a++)e+=String.fromCharCode(n[a]);return btoa(e)},be=t=>{const e=atob(t),n=e.length,s=new Uint8Array(n);for(let a=0;a<n;a++)s[a]=e.charCodeAt(a);return s.buffer};function ve(t){let e="";const n=t.length;for(let s=0;s<n;s++)e+=String.fromCharCode(t[s]);return btoa(e)}function se(t){const e=atob(t),n=e.length,s=new Uint8Array(n);for(let a=0;a<n;a++)s[a]=e.charCodeAt(a);return s}function Ie(t){let e,n,s="Website",a,r,i,c,p="Email",d,l,m,h,u="Password",o,f,T,w,M="Master Password",k,b,E,S,ee="Save",x,te;return{c(){e=g("form"),n=g("label"),n.textContent=s,a=A(),r=g("input"),i=A(),c=g("label"),c.textContent=p,d=A(),l=g("input"),m=A(),h=g("label"),h.textContent=u,o=A(),f=g("input"),T=A(),w=g("label"),w.textContent=M,k=A(),b=g("input"),E=A(),S=g("button"),S.textContent=ee,this.h()},l(B){e=y(B,"FORM",{class:!0});var C=R(e);n=y(C,"LABEL",{for:!0,"data-svelte-h":!0}),U(n)!=="svelte-q3ee2c"&&(n.textContent=s),a=D(C),r=y(C,"INPUT",{type:!0,name:!0,id:!0}),i=D(C),c=y(C,"LABEL",{for:!0,"data-svelte-h":!0}),U(c)!=="svelte-1p9d3fm"&&(c.textContent=p),d=D(C),l=y(C,"INPUT",{type:!0,name:!0,id:!0}),m=D(C),h=y(C,"LABEL",{for:!0,"data-svelte-h":!0}),U(h)!=="svelte-pepa0a"&&(h.textContent=u),o=D(C),f=y(C,"INPUT",{type:!0,name:!0,id:!0}),T=D(C),w=y(C,"LABEL",{for:!0,"data-svelte-h":!0}),U(w)!=="svelte-1xxtmvs"&&(w.textContent=M),k=D(C),b=y(C,"INPUT",{type:!0,name:!0,id:!0}),E=D(C),S=y(C,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),U(S)!=="svelte-1f2bxem"&&(S.textContent=ee),C.forEach(O),this.h()},h(){v(n,"for","website"),v(r,"type","text"),v(r,"name","website"),v(r,"id","website"),v(c,"for","email"),v(l,"type","text"),v(l,"name","email"),v(l,"id","email"),v(h,"for","password"),v(f,"type","text"),v(f,"name","password"),v(f,"id","password"),v(w,"for","masterPassword"),v(b,"type","text"),v(b,"name","masterPassword"),v(b,"id","masterPassword"),v(S,"type","submit"),v(S,"class","svelte-qfhzue"),v(e,"class","svelte-qfhzue")},m(B,C){P(B,e,C),_(e,n),_(e,a),_(e,r),N(r,t[2]),_(e,i),_(e,c),_(e,d),_(e,l),N(l,t[0]),_(e,m),_(e,h),_(e,o),_(e,f),N(f,t[1]),_(e,T),_(e,w),_(e,k),_(e,b),N(b,t[3]),_(e,E),_(e,S),x||(te=[L(r,"input",t[6]),L(l,"input",t[7]),L(f,"input",t[8]),L(b,"input",t[9]),L(e,"submit",ce(t[4]))],x=!0)},p(B,[C]){C&4&&r.value!==B[2]&&N(r,B[2]),C&1&&l.value!==B[0]&&N(l,B[0]),C&2&&f.value!==B[1]&&N(f,B[1]),C&8&&b.value!==B[3]&&N(b,B[3])},i:z,o:z,d(B){B&&O(e),x=!1,de(te)}}}function je(t,e,n){let{isOpen:s=!1}=e;const a=()=>{Ne(p,ge(),i).then(u=>{u==="ERROR"||fe.post("/vault",{website:c,email:r,password:u.encryptedData,iv:u.iv}).then(o=>{o.status===200&&n(5,s=!1)})})};let r="",i="",c="",p="";function d(){c=this.value,n(2,c)}function l(){r=this.value,n(0,r)}function m(){i=this.value,n(1,i)}function h(){p=this.value,n(3,p)}return t.$$set=u=>{"isOpen"in u&&n(5,s=u.isOpen)},[r,i,c,p,a,s,d,l,m,h]}class Ke extends Q{constructor(e){super(),X(this,e,je,Ie,J,{isOpen:5})}}function ae(t){let e,n,s,a,r;const i=t[4].default,c=Ce(i,t,t[3],null);return{c(){e=g("div"),n=g("div"),c&&c.c(),this.h()},l(p){e=y(p,"DIV",{class:!0});var d=R(e);n=y(d,"DIV",{class:!0});var l=R(n);c&&c.l(l),l.forEach(O),d.forEach(O),this.h()},h(){v(n,"class","modal-content svelte-18aoxsx"),v(e,"class","modal-overlay svelte-18aoxsx")},m(p,d){P(p,e,d),_(e,n),c&&c.m(n,null),s=!0,a||(r=L(e,"click",t[1]),a=!0)},p(p,d){c&&c.p&&(!s||d&8)&&Te(c,i,p,p[3],s?ke(i,p[3],d,null):Ee(p[3]),null)},i(p){s||(q(c,p),s=!0)},o(p){I(c,p),s=!1},d(p){p&&O(e),c&&c.d(p),a=!1,r()}}}function Ve(t){let e,n,s=t[0]&&ae(t);return{c(){s&&s.c(),e=ne()},l(a){s&&s.l(a),e=ne()},m(a,r){s&&s.m(a,r),P(a,e,r),n=!0},p(a,[r]){a[0]?s?(s.p(a,r),r&1&&q(s,1)):(s=ae(a),s.c(),q(s,1),s.m(e.parentNode,e)):s&&(Pe(),I(s,1,1,()=>{s=null}),Be())},i(a){n||(q(s),n=!0)},o(a){I(s),n=!1},d(a){a&&O(e),s&&s.d(a)}}}function ze(t,e,n){let{$$slots:s={},$$scope:a}=e,{isOpen:r=!1}=e,{closeOnClickOutside:i=!0}=e;const c=Oe();function p(){n(0,r=!1),c("close")}function d(m){i&&m.target===m.currentTarget&&p()}function l(m){m.key==="Escape"&&p()}return pe(()=>(document.addEventListener("keydown",l),()=>{document.removeEventListener("keydown",l)})),t.$$set=m=>{"isOpen"in m&&n(0,r=m.isOpen),"closeOnClickOutside"in m&&n(2,i=m.closeOnClickOutside),"$$scope"in m&&n(3,a=m.$$scope)},[r,d,i,a,s]}class we extends Q{constructor(e){super(),X(this,e,ze,Ve,J,{isOpen:0,closeOnClickOutside:2})}}function le(t){let e,n,s,a,r,i="Copy",c,p;return{c(){e=g("h3"),n=H("Revealed Password: "),s=H(t[3]),a=A(),r=g("button"),r.textContent=i,this.h()},l(d){e=y(d,"H3",{});var l=R(e);n=F(l,"Revealed Password: "),s=F(l,t[3]),l.forEach(O),a=D(d),r=y(d,"BUTTON",{class:!0,"data-svelte-h":!0}),U(r)!=="svelte-1i03vi4"&&(r.textContent=i),this.h()},h(){v(r,"class","Copy")},m(d,l){P(d,e,l),_(e,n),_(e,s),P(d,a,l),P(d,r,l),c||(p=L(r,"click",t[5]),c=!0)},p(d,l){l&8&&he(s,d[3])},d(d){d&&(O(e),O(a),O(r)),c=!1,p()}}}function He(t){let e,n,s,a,r,i,c="Enter Master Password",p,d,l,m,h="Reveal",u,o,f,T="Exit",w,M,k=t[3]!=="N/A"&&le(t);return{c(){e=g("form"),n=g("h3"),s=H("Password to reveal: "),a=H(t[1]),r=A(),i=g("label"),i.textContent=c,p=A(),d=g("input"),l=A(),m=g("button"),m.textContent=h,u=A(),k&&k.c(),o=A(),f=g("button"),f.textContent=T,this.h()},l(b){e=y(b,"FORM",{});var E=R(e);n=y(E,"H3",{});var S=R(n);s=F(S,"Password to reveal: "),a=F(S,t[1]),S.forEach(O),r=D(E),i=y(E,"LABEL",{for:!0,"data-svelte-h":!0}),U(i)!=="svelte-1m3ozag"&&(i.textContent=c),p=D(E),d=y(E,"INPUT",{type:!0,id:!0}),l=D(E),m=y(E,"BUTTON",{type:!0,"data-svelte-h":!0}),U(m)!=="svelte-wmvqau"&&(m.textContent=h),E.forEach(O),u=D(b),k&&k.l(b),o=D(b),f=y(b,"BUTTON",{class:!0,"data-svelte-h":!0}),U(f)!=="svelte-kq22ao"&&(f.textContent=T),this.h()},h(){v(i,"for","password"),v(d,"type","password"),v(d,"id","password"),v(m,"type","submit"),v(f,"class","exit")},m(b,E){P(b,e,E),_(e,n),_(n,s),_(n,a),_(e,r),_(e,i),_(e,p),_(e,d),N(d,t[2]),_(e,l),_(e,m),P(b,u,E),k&&k.m(b,E),P(b,o,E),P(b,f,E),w||(M=[L(d,"input",t[7]),L(e,"submit",ce(t[4])),L(f,"click",t[8])],w=!0)},p(b,[E]){E&2&&he(a,b[1]),E&4&&d.value!==b[2]&&N(d,b[2]),b[3]!=="N/A"?k?k.p(b,E):(k=le(b),k.c(),k.m(o.parentNode,o)):k&&(k.d(1),k=null)},i:z,o:z,d(b){b&&(O(e),O(u),O(o),O(f)),k&&k.d(b),w=!1,de(M)}}}function Fe(t,e,n){let{data:s}=e,{iv:a}=e,{isOpen:r}=e,i="",c="N/A";const p=()=>{qe(i,Ae(ye),s,a).then(h=>{n(3,c=h)})},d=()=>{navigator.clipboard.writeText(c)};function l(){i=this.value,n(2,i)}const m=()=>n(0,r=!1);return t.$$set=h=>{"data"in h&&n(1,s=h.data),"iv"in h&&n(6,a=h.iv),"isOpen"in h&&n(0,r=h.isOpen)},[r,s,i,c,p,d,a,l,m]}class We extends Q{constructor(e){super(),X(this,e,Fe,He,J,{data:1,iv:6,isOpen:0})}}function re(t,e,n){const s=t.slice();return s[12]=e[n],s}function oe(t,e,n){const s=t.slice();return s[15]=e[n],s}function Ge(t){let e,n,s,a,r;function i(l){t[6](l)}function c(l){t[7](l)}function p(l){t[8](l)}let d={};return t[0]!==void 0&&(d.isOpen=t[0]),t[1]!==void 0&&(d.data=t[1]),t[2]!==void 0&&(d.iv=t[2]),e=new We({props:d}),j.push(()=>V(e,"isOpen",i)),j.push(()=>V(e,"data",c)),j.push(()=>V(e,"iv",p)),{c(){W(e.$$.fragment)},l(l){G(e.$$.fragment,l)},m(l,m){$(e,l,m),r=!0},p(l,m){const h={};!n&&m&1&&(n=!0,h.isOpen=l[0],K(()=>n=!1)),!s&&m&2&&(s=!0,h.data=l[1],K(()=>s=!1)),!a&&m&4&&(a=!0,h.iv=l[2],K(()=>a=!1)),e.$set(h)},i(l){r||(q(e.$$.fragment,l),r=!0)},o(l){I(e.$$.fragment,l),r=!1},d(l){Y(e,l)}}}function ie(t){let e,n=t[15]+"",s;return{c(){e=g("td"),s=H(n),this.h()},l(a){e=y(a,"TD",{class:!0});var r=R(e);s=F(r,n),r.forEach(O),this.h()},h(){v(e,"class","svelte-6s0oqu")},m(a,r){P(a,e,r),_(e,s)},p:z,d(a){a&&O(e)}}}function ue(t){let e,n,s,a,r="Reveal",i,c,p,d=Z(Object.values(t[12])),l=[];for(let h=0;h<d.length;h+=1)l[h]=ie(oe(t,d,h));function m(){return t[10](t[12])}return{c(){e=g("tr");for(let h=0;h<l.length;h+=1)l[h].c();n=A(),s=g("td"),a=g("button"),a.textContent=r,i=A(),this.h()},l(h){e=y(h,"TR",{});var u=R(e);for(let f=0;f<l.length;f+=1)l[f].l(u);n=D(u),s=y(u,"TD",{class:!0});var o=R(s);a=y(o,"BUTTON",{class:!0,"data-svelte-h":!0}),U(a)!=="svelte-tfw9db"&&(a.textContent=r),o.forEach(O),i=D(u),u.forEach(O),this.h()},h(){v(a,"class","reveal"),v(s,"class","svelte-6s0oqu")},m(h,u){P(h,e,u);for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(e,null);_(e,n),_(e,s),_(s,a),_(e,i),c||(p=L(a,"click",m),c=!0)},p(h,u){if(t=h,u&8){d=Z(Object.values(t[12]));let o;for(o=0;o<d.length;o+=1){const f=oe(t,d,o);l[o]?l[o].p(f,u):(l[o]=ie(f),l[o].c(),l[o].m(e,n))}for(;o<l.length;o+=1)l[o].d(1);l.length=d.length}},d(h){h&&O(e),me(l,h),c=!1,p()}}}function $e(t){let e,n,s,a,r,i='<tr class="header svelte-6s0oqu"><th class="svelte-6s0oqu">Website</th> <th class="svelte-6s0oqu">Email</th> <th class="svelte-6s0oqu">Password</th> </tr><tr></tr>',c,p,d;function l(o){t[9](o)}let m={$$slots:{default:[Ge]},$$scope:{ctx:t}};t[0]!==void 0&&(m.isOpen=t[0]),e=new we({props:m}),j.push(()=>V(e,"isOpen",l));let h=Z(Object.values(t[3])),u=[];for(let o=0;o<h.length;o+=1)u[o]=ue(re(t,h,o));return{c(){W(e.$$.fragment),s=A(),a=g("table"),r=g("thead"),r.innerHTML=i,c=A(),p=g("tbody");for(let o=0;o<u.length;o+=1)u[o].c();this.h()},l(o){G(e.$$.fragment,o),s=D(o),a=y(o,"TABLE",{class:!0});var f=R(a);r=y(f,"THEAD",{"data-svelte-h":!0}),U(r)!=="svelte-1czv9h"&&(r.innerHTML=i),c=D(f),p=y(f,"TBODY",{});var T=R(p);for(let w=0;w<u.length;w+=1)u[w].l(T);T.forEach(O),f.forEach(O),this.h()},h(){v(a,"class","svelte-6s0oqu")},m(o,f){$(e,o,f),P(o,s,f),P(o,a,f),_(a,r),_(a,c),_(a,p);for(let T=0;T<u.length;T+=1)u[T]&&u[T].m(p,null);d=!0},p(o,[f]){const T={};if(f&262151&&(T.$$scope={dirty:f,ctx:o}),!n&&f&1&&(n=!0,T.isOpen=o[0],K(()=>n=!1)),e.$set(T),f&31){h=Z(Object.values(o[3]));let w;for(w=0;w<h.length;w+=1){const M=re(o,h,w);u[w]?u[w].p(M,f):(u[w]=ue(M),u[w].c(),u[w].m(p,null))}for(;w<u.length;w+=1)u[w].d(1);u.length=h.length}},i(o){d||(q(e.$$.fragment,o),d=!0)},o(o){I(e.$$.fragment,o),d=!1},d(o){o&&(O(s),O(a)),Y(e,o),me(u,o)}}}function Ye(t,e,n){let{tableData:s=[]}=e,a=s.map(f=>({website:f.website,email:f.email,password:f.password})),r=[];const i=f=>{const T=r.find(w=>w.website===f);return T?T.iv:""};let c=!1,p="",d="";function l(f){c=f,n(0,c)}function m(f){p=f,n(1,p)}function h(f){d=f,n(2,d)}function u(f){c=f,n(0,c)}const o=f=>{n(1,p=f.password),n(2,d=i(f.website)),n(0,c=!0)};return t.$$set=f=>{"tableData"in f&&n(5,s=f.tableData)},t.$$.update=()=>{t.$$.dirty&32&&s.forEach(f=>r.push({website:f.website,iv:f.iv}))},[c,p,d,a,i,s,l,m,h,u,o]}class Je extends Q{constructor(e){super(),X(this,e,Ye,$e,J,{tableData:5})}}function Qe(t){let e,n,s;function a(i){t[3](i)}let r={};return t[1]!==void 0&&(r.isOpen=t[1]),e=new Ke({props:r}),j.push(()=>V(e,"isOpen",a)),{c(){W(e.$$.fragment)},l(i){G(e.$$.fragment,i)},m(i,c){$(e,i,c),s=!0},p(i,c){const p={};!n&&c&2&&(n=!0,p.isOpen=i[1],K(()=>n=!1)),e.$set(p)},i(i){s||(q(e.$$.fragment,i),s=!0)},o(i){I(e.$$.fragment,i),s=!1},d(i){Y(e,i)}}}function Xe(t){let e,n,s,a,r,i,c="+",p,d,l;function m(u){t[4](u)}let h={$$slots:{default:[Qe]},$$scope:{ctx:t}};return t[1]!==void 0&&(h.isOpen=t[1]),e=new we({props:h}),j.push(()=>V(e,"isOpen",m)),a=new Je({props:{tableData:t[0].passwords}}),{c(){W(e.$$.fragment),s=A(),W(a.$$.fragment),r=A(),i=g("button"),i.textContent=c,this.h()},l(u){G(e.$$.fragment,u),s=D(u),G(a.$$.fragment,u),r=D(u),i=y(u,"BUTTON",{class:!0,"data-svelte-h":!0}),U(i)!=="svelte-l6amdm"&&(i.textContent=c),this.h()},h(){v(i,"class","svelte-j38glp")},m(u,o){$(e,u,o),P(u,s,o),$(a,u,o),P(u,r,o),P(u,i,o),p=!0,d||(l=L(i,"click",t[5]),d=!0)},p(u,[o]){const f={};o&130&&(f.$$scope={dirty:o,ctx:u}),!n&&o&2&&(n=!0,f.isOpen=u[1],K(()=>n=!1)),e.$set(f);const T={};o&1&&(T.tableData=u[0].passwords),a.$set(T)},i(u){p||(q(e.$$.fragment,u),q(a.$$.fragment,u),p=!0)},o(u){I(e.$$.fragment,u),I(a.$$.fragment,u),p=!1},d(u){u&&(O(s),O(r),O(i)),Y(e,u),Y(a,u),d=!1,l()}}}function Ze(t,e,n){let s,a;De(t,Se,l=>n(2,a=l));let{data:r=[]}=e;pe(async()=>{await Ue(s)});let i=!1;function c(l){i=l,n(1,i)}function p(l){i=l,n(1,i)}const d=()=>n(1,i=!0);return t.$$set=l=>{"data"in l&&n(0,r=l.data)},t.$$.update=()=>{t.$$.dirty&4&&(s=a.url.pathname)},[r,i,a,c,p,d]}class lt extends Q{constructor(e){super(),X(this,e,Ze,Xe,J,{data:0})}}export{lt as component,at as universal};
