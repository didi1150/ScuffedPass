import{s as E,q,b as h,f as K,h as v,j,r as k,l as P,d as z,v as p,i as R,m as d,w as T,x as U,y as D,z as L,B as N}from"../chunks/scheduler.DLXp1mf0.js";import{S as V,i as W,b as A,d as F,e as H,m as Y,t as G,a as J,f as Q}from"../chunks/index.CDjF2aYJ.js";import{g as I}from"../chunks/entry.DszAjk8y.js";import{I as X}from"../chunks/InputBox.D2QTA3o3.js";import{b as Z,a as C,g as tt,s as et,c as at,d as st,e as ot}from"../chunks/axios.Cqd8ba7t.js";import{h as nt,d as rt,a as lt}from"../chunks/key.Dz1h-UZO.js";const it=!1,_t=Object.freeze(Object.defineProperty({__proto__:null,ssr:it},Symbol.toStringTag,{value:"Module"}));function ct(i){let a,l,w="Your vault is locked.",_,t,s,c,b,o,n,x="Unlock",y,r,$="Logout",f,g,M;function B(e){i[3](e)}let O={id:"password",label:"Enter master password",type:"password",required:!0};return i[0]!==void 0&&(O.value=i[0]),s=new X({props:O}),q.push(()=>A(s,"value",B)),{c(){a=h("div"),l=h("h2"),l.textContent=w,_=K(),t=h("form"),F(s.$$.fragment),b=K(),o=h("div"),n=h("button"),n.textContent=x,y=K(),r=h("button"),r.textContent=$,this.h()},l(e){a=v(e,"DIV",{class:!0});var u=j(a);l=v(u,"H2",{class:!0,"data-svelte-h":!0}),k(l)!=="svelte-ckhoc5"&&(l.textContent=w),_=P(u),t=v(u,"FORM",{method:!0,class:!0});var m=j(t);H(s.$$.fragment,m),b=P(m),o=v(m,"DIV",{class:!0});var S=j(o);n=v(S,"BUTTON",{class:!0,"data-svelte-h":!0}),k(n)!=="svelte-184by3v"&&(n.textContent=x),y=P(S),r=v(S,"BUTTON",{class:!0,"data-svelte-h":!0}),k(r)!=="svelte-15ll9dz"&&(r.textContent=$),S.forEach(z),m.forEach(z),u.forEach(z),this.h()},h(){p(l,"class","svelte-z2bjws"),p(n,"class","submit svelte-z2bjws"),p(r,"class","logout svelte-z2bjws"),p(o,"class","control svelte-z2bjws"),p(t,"method","post"),p(t,"class","svelte-z2bjws"),p(a,"class","frame svelte-z2bjws")},m(e,u){R(e,a,u),d(a,l),d(a,_),d(a,t),Y(s,t,null),d(t,b),d(t,o),d(o,n),d(o,y),d(o,r),f=!0,g||(M=[T(n,"submit",i[1]),T(r,"click",i[2]),T(t,"submit",U(i[1]))],g=!0)},p(e,[u]){const m={};!c&&u&1&&(c=!0,m.value=e[0],D(()=>c=!1)),s.$set(m)},i(e){f||(G(s.$$.fragment,e),f=!0)},o(e){J(s.$$.fragment,e),f=!1},d(e){e&&z(a),Q(s),g=!1,L(M)}}}function ut(i,a,l){N(()=>{Z()&&I("/")});const w=async()=>{const c=(await C.get("/auth/account/user")).data,b=await tt(c),{hashPW:o}=await nt(c,t,b),n=await C.post("/auth/account/user/encryptionKey",{hash:o}),{encryptionKey:x,privateKeyMaster:y,iv:r,salt:$}=n.data,f=await rt(y,t,$,r),g=await lt(x,f);et(g),await I("/")},_=async()=>{await C.post("/auth/account/logout"),at(""),st(""),ot(""),C.defaults.headers.common.Authorization="",await I("/login")};let t="";function s(c){t=c,l(0,t)}return[t,w,_,s]}class bt extends V{constructor(a){super(),W(this,a,ut,ct,E,{})}}export{bt as component,_t as universal};
