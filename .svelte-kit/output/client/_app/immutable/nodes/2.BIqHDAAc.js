import{g as S}from"../chunks/entry.DszAjk8y.js";import{a as U,c as x,d as ee,e as te}from"../chunks/axios.Cqd8ba7t.js";import{r as ce,h as se}from"../chunks/roles.CnO6KcgF.js";import{s as le,f as N,b,l as I,h as $,j as B,d as p,r as H,v as g,i as y,m as L,w as q,F as ne,o as Q,z as ae,K as me,q as ie,c as pe,y as oe,u as de,g as _e,a as he,e as K}from"../chunks/scheduler.DLXp1mf0.js";import{S as re,i as ue,b as fe,d as j,e as z,m as A,t as V,a as E,f as P,g as ge,c as ve}from"../chunks/index.CDjF2aYJ.js";import{M as be}from"../chunks/Modal.Bfgxw4_d.js";import{C as $e}from"../chunks/ChangeMasterPassword.B1j-w_Qt.js";import{M as G}from"../chunks/MediaQuery.DweYF8x5.js";const ke=async l=>{try{const e=await U.get("/auth/account/user");return(l==="/login"||l==="/register")&&await S("/"),e.status!==200&&await S("/login"),"succeed"}catch(e){console.error("Failed to verify user token:",e),await S("/login")}},we=!1;let D=!1;const Te=async({url:l})=>{if(!D){if(D=!0,!await ke(l.pathname))throw ce(303,"/login");D=!1}},De=Object.freeze(Object.defineProperty({__proto__:null,load:Te,ssr:we},Symbol.toStringTag,{value:"Module"}));function J(l){let e,s,t;return{c(){e=b("div"),this.h()},l(a){e=$(a,"DIV",{class:!0}),B(e).forEach(p),this.h()},h(){g(e,"class","backdrop svelte-g332p4")},m(a,r){y(a,e,r),s||(t=q(e,"click",l[4]),s=!0)},p:Q,d(a){a&&p(e),s=!1,t()}}}function W(l){let e,s='<a href="/" class="svelte-g332p4"><h2>Vault</h2></a>';return{c(){e=b("li"),e.innerHTML=s,this.h()},l(t){e=$(t,"LI",{class:!0,"data-svelte-h":!0}),H(e)!=="svelte-juvom7"&&(e.innerHTML=s),this.h()},h(){g(e,"class","svelte-g332p4")},m(t,a){y(t,e,a)},d(t){t&&p(e)}}}function X(l){let e,s='<a href="/users" class="svelte-g332p4"><h2>Users</h2></a>';return{c(){e=b("li"),e.innerHTML=s,this.h()},l(t){e=$(t,"LI",{class:!0,"data-svelte-h":!0}),H(e)!=="svelte-1wfzfkn"&&(e.innerHTML=s),this.h()},h(){g(e,"class","svelte-g332p4")},m(t,a){y(t,e,a)},d(t){t&&p(e)}}}function ye(l){let e,s,t,a,r,n,f,c,h,u,k="<h2>Change Masterpassword</h2>",m,i,o,C="<h2>Logout</h2>",M,O,v=l[1]&&J(l),w=!l[0]&&W(),T=l[3]&&X();return{c(){v&&v.c(),e=N(),s=b("input"),t=N(),a=b("div"),r=N(),n=b("ul"),w&&w.c(),f=N(),T&&T.c(),c=N(),h=b("li"),u=b("button"),u.innerHTML=k,m=N(),i=b("li"),o=b("button"),o.innerHTML=C,this.h()},l(d){v&&v.l(d),e=I(d),s=$(d,"INPUT",{type:!0,class:!0}),t=I(d),a=$(d,"DIV",{class:!0}),B(a).forEach(p),r=I(d),n=$(d,"UL",{class:!0});var _=B(n);w&&w.l(_),f=I(_),T&&T.l(_),c=I(_),h=$(_,"LI",{class:!0});var F=B(h);u=$(F,"BUTTON",{class:!0,"data-svelte-h":!0}),H(u)!=="svelte-r0mkpf"&&(u.innerHTML=k),F.forEach(p),m=I(_),i=$(_,"LI",{class:!0});var R=B(i);o=$(R,"BUTTON",{class:!0,"data-svelte-h":!0}),H(o)!=="svelte-inkx71"&&(o.innerHTML=C),R.forEach(p),_.forEach(p),this.h()},h(){g(s,"type","checkbox"),g(s,"class","toggle-menu svelte-g332p4"),g(a,"class","hamburger svelte-g332p4"),g(u,"class","svelte-g332p4"),g(h,"class","svelte-g332p4"),g(o,"class","svelte-g332p4"),g(i,"class","svelte-g332p4"),g(n,"class","list svelte-g332p4")},m(d,_){v&&v.m(d,_),y(d,e,_),y(d,s,_),s.checked=l[1],y(d,t,_),y(d,a,_),y(d,r,_),y(d,n,_),w&&w.m(n,null),L(n,f),T&&T.m(n,null),L(n,c),L(n,h),L(h,u),L(n,m),L(n,i),L(i,o),M||(O=[q(s,"change",l[7]),q(u,"click",l[6]),q(o,"click",function(){ne(l[2])&&l[2].apply(this,arguments)})],M=!0)},p(d,[_]){l=d,l[1]?v?v.p(l,_):(v=J(l),v.c(),v.m(e.parentNode,e)):v&&(v.d(1),v=null),_&2&&(s.checked=l[1]),l[0]?w&&(w.d(1),w=null):w||(w=W(),w.c(),w.m(n,f)),l[3]?T||(T=X(),T.c(),T.m(n,c)):T&&(T.d(1),T=null)},i:Q,o:Q,d(d){d&&(p(e),p(s),p(t),p(a),p(r),p(n)),v&&v.d(d),w&&w.d(),T&&T.d(),M=!1,ae(O)}}}function Ce(l,e,s){let t,a,{isVault:r=!1}=e,n=!1;const f=u=>{const k=document.getElementsByClassName("toggle-menu").item(0);k&&(k instanceof HTMLInputElement&&(k.checked=!1),s(1,n=!1))};function c(u){me.call(this,l,u)}function h(){n=this.checked,s(1,n)}return l.$$set=u=>{"isVault"in u&&s(0,r=u.isVault)},l.$$.update=()=>{l.$$.dirty&32&&s(2,a=async()=>{await U.post("/auth/account/logout"),x(""),ee(""),te(""),s(5,U.defaults.headers.common.Authorization="",U),await S("/login")})},s(3,t=se("admin")),[r,n,a,t,f,U,c,h]}class Oe extends re{constructor(e){super(),ue(this,e,Ce,ye,le,{isVault:0})}}function Y(l){let e,s,t;function a(n){l[6](n)}let r={};return l[0]!==void 0&&(r.isOpen=l[0]),e=new $e({props:r}),ie.push(()=>fe(e,"isOpen",a)),{c(){j(e.$$.fragment)},l(n){z(e.$$.fragment,n)},m(n,f){A(e,n,f),t=!0},p(n,f){const c={};!s&&f&1&&(s=!0,c.isOpen=n[0],oe(()=>s=!1)),e.$set(c)},i(n){t||(V(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){P(e,n)}}}function Le(l){let e,s,t=l[1]==="change"&&Y(l);return{c(){t&&t.c(),e=K()},l(a){t&&t.l(a),e=K()},m(a,r){t&&t.m(a,r),y(a,e,r),s=!0},p(a,r){a[1]==="change"?t?(t.p(a,r),r&2&&V(t,1)):(t=Y(a),t.c(),V(t,1),t.m(e.parentNode,e)):t&&(ge(),E(t,1,1,()=>{t=null}),ve())},i(a){s||(V(t),s=!0)},o(a){E(t),s=!1},d(a){a&&p(e),t&&t.d(a)}}}function Me(l){let e,s;return e=new Oe({}),{c(){j(e.$$.fragment)},l(t){z(e.$$.fragment,t)},m(t,a){A(e,t,a),s=!0},i(t){s||(V(e.$$.fragment,t),s=!0)},o(t){E(e.$$.fragment,t),s=!1},d(t){P(e,t)}}}function Z(l){let e,s="Users",t,a;return{c(){e=b("button"),e.textContent=s,this.h()},l(r){e=$(r,"BUTTON",{class:!0,"data-svelte-h":!0}),H(e)!=="svelte-1wjx4u"&&(e.textContent=s),this.h()},h(){g(e,"class","users svelte-151g2g2")},m(r,n){y(r,e,n),t||(a=q(e,"click",l[10]),t=!0)},d(r){r&&p(e),t=!1,a()}}}function Ne(l){let e,s,t,a="Vault",r,n,f="Change Master Password",c,h,u,k="Logout",m,i,o=l[3]&&Z(l);return{c(){e=b("nav"),s=b("div"),t=b("button"),t.textContent=a,r=N(),n=b("button"),n.textContent=f,c=N(),o&&o.c(),h=N(),u=b("button"),u.textContent=k,this.h()},l(C){e=$(C,"NAV",{class:!0});var M=B(e);s=$(M,"DIV",{class:!0});var O=B(s);t=$(O,"BUTTON",{class:!0,"data-svelte-h":!0}),H(t)!=="svelte-1kdmd62"&&(t.textContent=a),r=I(O),n=$(O,"BUTTON",{class:!0,"data-svelte-h":!0}),H(n)!=="svelte-893euc"&&(n.textContent=f),c=I(O),o&&o.l(O),h=I(O),u=$(O,"BUTTON",{class:!0,"data-svelte-h":!0}),H(u)!=="svelte-1pvvsj5"&&(u.textContent=k),O.forEach(p),M.forEach(p),this.h()},h(){g(t,"class","vault svelte-151g2g2"),g(n,"class","svelte-151g2g2"),g(u,"class","logout svelte-151g2g2"),g(s,"class","controls"),g(e,"class","svelte-151g2g2")},m(C,M){y(C,e,M),L(e,s),L(s,t),L(s,r),L(s,n),L(s,c),o&&o.m(s,null),L(s,h),L(s,u),m||(i=[q(t,"click",l[8]),q(n,"click",l[9]),q(u,"click",function(){ne(l[2])&&l[2].apply(this,arguments)})],m=!0)},p(C,M){l=C,l[3]?o||(o=Z(l),o.c(),o.m(s,h)):o&&(o.d(1),o=null)},d(C){C&&p(e),o&&o.d(),m=!1,ae(i)}}}function Ie(l){let e,s,t,a,r,n,f,c;function h(i){l[7](i)}let u={$$slots:{default:[Le]},$$scope:{ctx:l}};l[0]!==void 0&&(u.isOpen=l[0]),e=new be({props:u}),ie.push(()=>fe(e,"isOpen",h)),a=new G({props:{query:Ue,$$slots:{default:[Me]},$$scope:{ctx:l}}}),n=new G({props:{query:Ve,$$slots:{default:[Ne]},$$scope:{ctx:l}}});const k=l[5].default,m=pe(k,l,l[11],null);return{c(){j(e.$$.fragment),t=N(),j(a.$$.fragment),r=N(),j(n.$$.fragment),f=N(),m&&m.c()},l(i){z(e.$$.fragment,i),t=I(i),z(a.$$.fragment,i),r=I(i),z(n.$$.fragment,i),f=I(i),m&&m.l(i)},m(i,o){A(e,i,o),y(i,t,o),A(a,i,o),y(i,r,o),A(n,i,o),y(i,f,o),m&&m.m(i,o),c=!0},p(i,[o]){const C={};o&2051&&(C.$$scope={dirty:o,ctx:i}),!s&&o&1&&(s=!0,C.isOpen=i[0],oe(()=>s=!1)),e.$set(C);const M={};o&2048&&(M.$$scope={dirty:o,ctx:i}),a.$set(M);const O={};o&2063&&(O.$$scope={dirty:o,ctx:i}),n.$set(O),m&&m.p&&(!c||o&2048)&&de(m,k,i,i[11],c?he(k,i[11],o,null):_e(i[11]),null)},i(i){c||(V(e.$$.fragment,i),V(a.$$.fragment,i),V(n.$$.fragment,i),V(m,i),c=!0)},o(i){E(e.$$.fragment,i),E(a.$$.fragment,i),E(n.$$.fragment,i),E(m,i),c=!1},d(i){i&&(p(t),p(r),p(f)),P(e,i),P(a,i),P(n,i),m&&m.d(i)}}}let Ue="(max-width: 600px)",Ve="(min-width: 601px)";function Ee(l,e,s){let t,a,{$$slots:r={},$$scope:n}=e,f=!1,c="lock";function h(o){f=o,s(0,f)}function u(o){f=o,s(0,f)}const k=()=>S("/vault"),m=()=>{s(1,c="change"),s(0,f=!0)},i=()=>S("/users");return l.$$set=o=>{"$$scope"in o&&s(11,n=o.$$scope)},l.$$.update=()=>{l.$$.dirty&16&&s(2,a=async()=>{await U.post("/auth/account/logout"),x(""),ee(""),te(""),s(4,U.defaults.headers.common.Authorization="",U),await S("/login")})},s(3,t=se("admin")),[f,c,a,t,U,r,h,u,k,m,i,n]}class Qe extends re{constructor(e){super(),ue(this,e,Ee,Ie,le,{})}}export{Qe as component,De as universal};
